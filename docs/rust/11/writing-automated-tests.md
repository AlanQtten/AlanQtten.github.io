# 书写自动维护的测试

在Edsger W. Dijkstra 1972年的文章“The Humble Programmer”（谦虚的程序员）中，他曾说过，“Program testing can be a very effective way to show the presence of bugs, but it is hopelessly inadequate for showing their absence”（程序测试可以非常有效地显示错误的存在，但却无法充分证明错误的不存在）。尽管如此，我们还是要对我们的代码进行充分的测试。

程序的正确性也是我们业务的完成度。Rust从设计之初就十分关注程序的正确性，但是正确性非常复杂，很难被证明。Rust的类型系统挑起了一大部分担子，但它并不能做到完美。因此，Rust也设计了一套测试框架，帮助我们编写可以自动维护的测试。

假设我们书写了一个函数`add_two`，它可以接收一个数字，增加2后返回。这个函数接收一个整数类型的参数，并返回一个整数类型。当我们实现并编译这个函数时，Rust进行了我们之前讨论过的类型检查和借用检查，例如，你不可以给这个函数传入`String`类型或者无效的引用类型。但是Rust*无法*检查这个函数的逻辑是否正确，也就是对参数加2的操作，如果函数的实现对参数增加了10甚至减去了50，Rust是不得而知的。这就是测试要发挥的地方。

我们可以书写断言测试，比如，当我们给`add_two`传递`3`时，它的返回值应当为`5`。我们可以在任何源码发生改变后运行这个测试，来保证函数的行为一定是正确的。

测试是一门复杂的学问：尽管这一章无法讨论所有优秀测试的细节，但我们会深入Rust的测试框架。我们会介绍书写测试需要用到的注解和宏。以及运行测试时的默认行为和可配置项，最后我们会讨论如何把测试代码组织为单元测试和一体化测试。
